<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>OverAnnotatedRule (infer.Nullsafe.OverAnnotatedRule)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">infer</a> &#x00BB; <a href="../index.html">Nullsafe</a> &#x00BB; OverAnnotatedRule</nav><header class="odoc-preamble"><h1>Module <code><span>Nullsafe.OverAnnotatedRule</span></code></h1></header><div class="odoc-content"><p>Checks if a type in signature (e.g. return value) can be made more specific. NOTE: This rule is complementatary to assignment rule. While assignment rule checks a single assignment `lhs = rhs`, this rule checks checks ALL assignments to `lhs` in the program. NOTE: Violation of this rule is not a type violation, hence it should never be surfaced as error: `lhs`'s type can be intentionally made broad by code author (e.g. to anticipate future changes in the implementation). Heuristits are required to correctly surface overannotated rule to the user. This rule is useful for some scenarios, especially for nullability code conversions when it is expected that some signatures were annotated with <code>@Nullable</code> defensively, so surfacing such cases can improve API and make migration smooth.</p><div class="odoc-spec"><div class="spec type" id="type-violation" class="anchored"><a href="#type-violation" class="anchor"></a><code><span><span class="keyword">type</span> violation</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-compare_violation" class="anchored"><a href="#val-compare_violation" class="anchor"></a><code><span><span class="keyword">val</span> compare_violation : <span><a href="#type-violation">violation</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-violation">violation</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-check" class="anchored"><a href="#val-check" class="anchor"></a><code><span><span class="keyword">val</span> check : <span>what:<a href="../Nullability/index.html#type-t">Nullability.t</a> <span class="arrow">&#45;&gt;</span></span> <span>by_rhs_upper_bound:<a href="../Nullability/index.html#type-t">Nullability.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <a href="#type-violation">violation</a>)</span> <a href="../../IStdlib/IStd/index.html#type-result">IStdlib.IStd.result</a></span></span></code></div><div class="spec-doc"><p>Checks if the declared type for `what` can be narrowed, based on the information about all assignments `what = rhs_i`. If an upper bound of `rhs_i` over ALL assignents `what = rhs_i` that exist in the program is a _strict_ subtype of lhs, `lhs`'s type can be narrowed to be that upper bound.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-violation_type" class="anchored"><a href="#type-violation_type" class="anchor"></a><code><span><span class="keyword">type</span> violation_type</span><span> = </span></code><table><tr id="type-violation_type.FieldOverAnnoted" class="anchored"><td class="def variant constructor"><a href="#type-violation_type.FieldOverAnnoted" class="anchor"></a><code><span>| </span><span><span class="constructor">FieldOverAnnoted</span> <span class="keyword">of</span> <a href="../../IR/Fieldname/index.html#type-t">IR.Fieldname.t</a></span></code></td></tr><tr id="type-violation_type.ReturnOverAnnotated" class="anchored"><td class="def variant constructor"><a href="#type-violation_type.ReturnOverAnnotated" class="anchor"></a><code><span>| </span><span><span class="constructor">ReturnOverAnnotated</span> <span class="keyword">of</span> <a href="../../IR/Procname/Java/index.html#type-t">IR.Procname.Java.t</a></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Return value of a method can be made non-nullable</p><span class="comment-delim">*)</span></td></tr></table></div></div><div class="odoc-spec"><div class="spec value" id="val-compare_violation_type" class="anchored"><a href="#val-compare_violation_type" class="anchor"></a><code><span><span class="keyword">val</span> compare_violation_type : <span><a href="#type-violation_type">violation_type</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-violation_type">violation_type</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-violation_description" class="anchored"><a href="#val-violation_description" class="anchor"></a><code><span><span class="keyword">val</span> violation_description : <span><a href="#type-violation">violation</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-violation_type">violation_type</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div></div></body></html>