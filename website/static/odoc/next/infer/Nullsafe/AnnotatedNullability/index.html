<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>AnnotatedNullability (infer.Nullsafe.AnnotatedNullability)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">infer</a> &#x00BB; <a href="../index.html">Nullsafe</a> &#x00BB; AnnotatedNullability</nav><header class="odoc-preamble"><h1>Module <code><span>Nullsafe.AnnotatedNullability</span></code></h1></header><div class="odoc-content"><p>Nullability of a type in Java program (e.g. in a function or field declaration). It might come from explicit annotations (or lack of annotation), or from other sources, including conventions about defaults, models, or the mode nullsafe runs in. NOTE: This is complementary to <a href="../InferredNullability/index.html#type-t"><code>InferredNullability.t</code></a>. <a href="../InferredNullability/index.html"><code>InferredNullability</code></a> contains info about _actual_ nullability (what did nullsafe infer according to its flow-sensitive rules.). In contrast, AnnotatedNullability represents _formal_ type as it appears in the program code. NOTE: Nullsafe disregards user-provided annotations for local types, so annotated nullability applies only for types declared at methods and field level.</p><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = </span></code><table><tr id="type-t.Nullable" class="anchored"><td class="def variant constructor"><a href="#type-t.Nullable" class="anchor"></a><code><span>| </span><span><span class="constructor">Nullable</span> <span class="keyword">of</span> <a href="#type-nullable_origin">nullable_origin</a></span></code></td></tr><tr id="type-t.ProvisionallyNullable" class="anchored"><td class="def variant constructor"><a href="#type-t.ProvisionallyNullable" class="anchor"></a><code><span>| </span><span><span class="constructor">ProvisionallyNullable</span> <span class="keyword">of</span> <a href="../ProvisionalAnnotation/index.html#type-t">ProvisionalAnnotation.t</a></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Exist only for specical run modes</p><span class="comment-delim">*)</span></td></tr><tr id="type-t.ThirdPartyNonnull" class="anchored"><td class="def variant constructor"><a href="#type-t.ThirdPartyNonnull" class="anchor"></a><code><span>| </span><span><span class="constructor">ThirdPartyNonnull</span></span></code></td></tr><tr id="type-t.UncheckedNonnull" class="anchored"><td class="def variant constructor"><a href="#type-t.UncheckedNonnull" class="anchor"></a><code><span>| </span><span><span class="constructor">UncheckedNonnull</span> <span class="keyword">of</span> <a href="#type-unchecked_nonnull_origin">unchecked_nonnull_origin</a></span></code></td></tr><tr id="type-t.LocallyTrustedNonnull" class="anchored"><td class="def variant constructor"><a href="#type-t.LocallyTrustedNonnull" class="anchor"></a><code><span>| </span><span><span class="constructor">LocallyTrustedNonnull</span></span></code></td></tr><tr id="type-t.LocallyCheckedNonnull" class="anchored"><td class="def variant constructor"><a href="#type-t.LocallyCheckedNonnull" class="anchor"></a><code><span>| </span><span><span class="constructor">LocallyCheckedNonnull</span></span></code></td></tr><tr id="type-t.StrictNonnull" class="anchored"><td class="def variant constructor"><a href="#type-t.StrictNonnull" class="anchor"></a><code><span>| </span><span><span class="constructor">StrictNonnull</span> <span class="keyword">of</span> <a href="#type-strict_nonnull_origin">strict_nonnull_origin</a></span></code></td></tr></table></div><div class="spec-doc"><p>See <a href="../Nullability/index.html#type-t"><code>Nullability.t</code></a> for explanation</p></div></div><div class="odoc-spec"><div class="spec type" id="type-nullable_origin" class="anchored"><a href="#type-nullable_origin" class="anchor"></a><code><span><span class="keyword">and</span> nullable_origin</span><span> = </span></code><table><tr id="type-nullable_origin.AnnotatedNullable" class="anchored"><td class="def variant constructor"><a href="#type-nullable_origin.AnnotatedNullable" class="anchor"></a><code><span>| </span><span><span class="constructor">AnnotatedNullable</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>The type is expicitly annotated with <code>@Nullable</code> in the code</p><span class="comment-delim">*)</span></td></tr><tr id="type-nullable_origin.AnnotatedPropagatesNullable" class="anchored"><td class="def variant constructor"><a href="#type-nullable_origin.AnnotatedPropagatesNullable" class="anchor"></a><code><span>| </span><span><span class="constructor">AnnotatedPropagatesNullable</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>If a function param is annotated as <code>@PropagatesNullable</code>, this param is automatically nullable</p><span class="comment-delim">*)</span></td></tr><tr id="type-nullable_origin.HasPropagatesNullableInParam" class="anchored"><td class="def variant constructor"><a href="#type-nullable_origin.HasPropagatesNullableInParam" class="anchor"></a><code><span>| </span><span><span class="constructor">HasPropagatesNullableInParam</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>If a method has at least one param marked as <code>@PropagatesNullable</code>, return value is automatically nullable</p><span class="comment-delim">*)</span></td></tr><tr id="type-nullable_origin.ModelledNullable" class="anchored"><td class="def variant constructor"><a href="#type-nullable_origin.ModelledNullable" class="anchor"></a><code><span>| </span><span><span class="constructor">ModelledNullable</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>nullsafe knows it is nullable via its internal models</p><span class="comment-delim">*)</span></td></tr></table></div></div><div class="odoc-spec"><div class="spec type" id="type-unchecked_nonnull_origin" class="anchored"><a href="#type-unchecked_nonnull_origin" class="anchor"></a><code><span><span class="keyword">and</span> unchecked_nonnull_origin</span><span> = </span></code><table><tr id="type-unchecked_nonnull_origin.AnnotatedNonnull" class="anchored"><td class="def variant constructor"><a href="#type-unchecked_nonnull_origin.AnnotatedNonnull" class="anchor"></a><code><span>| </span><span><span class="constructor">AnnotatedNonnull</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>The type is explicitly annotated as non nullable via one of nonnull annotations Nullsafe recognizes</p><span class="comment-delim">*)</span></td></tr><tr id="type-unchecked_nonnull_origin.ImplicitlyNonnull" class="anchored"><td class="def variant constructor"><a href="#type-unchecked_nonnull_origin.ImplicitlyNonnull" class="anchor"></a><code><span>| </span><span><span class="constructor">ImplicitlyNonnull</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Infer was run in mode where all not annotated (non local) types are treated as non nullable</p><span class="comment-delim">*)</span></td></tr></table></div></div><div class="odoc-spec"><div class="spec type" id="type-strict_nonnull_origin" class="anchored"><a href="#type-strict_nonnull_origin" class="anchor"></a><code><span><span class="keyword">and</span> strict_nonnull_origin</span><span> = </span></code><table><tr id="type-strict_nonnull_origin.ExplicitNonnullThirdParty" class="anchored"><td class="def variant constructor"><a href="#type-strict_nonnull_origin.ExplicitNonnullThirdParty" class="anchor"></a><code><span>| </span><span><span class="constructor">ExplicitNonnullThirdParty</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Third party annotated as <code>@Nonnull</code> is considered strict. This is a controversial choice and might be an unsoundness issue. The reason is practical. The best we can do for third party is to register it in third party signature repository. Though this typically requires human review, in practice errors are inevitable. On the other hand, if the library owner explicitly annotated a function as nonnull, we assume this was made for reason. In practice, requiring such methods to be registered in third party folder, will introduce user friction but will not significantly increase safety. So our approach here is optimistic. If some particular method or library is known to contain wrong <code>@Nonnull</code> annotations, third party repository is a way to override this.</p><span class="comment-delim">*)</span></td></tr><tr id="type-strict_nonnull_origin.ModelledNonnull" class="anchored"><td class="def variant constructor"><a href="#type-strict_nonnull_origin.ModelledNonnull" class="anchor"></a><code><span>| </span><span><span class="constructor">ModelledNonnull</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>nullsafe knows it is non-nullable via its internal models</p><span class="comment-delim">*)</span></td></tr><tr id="type-strict_nonnull_origin.StrictMode" class="anchored"><td class="def variant constructor"><a href="#type-strict_nonnull_origin.StrictMode" class="anchor"></a><code><span>| </span><span><span class="constructor">StrictMode</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>under strict mode we consider non-null declarations to be trusted</p><span class="comment-delim">*)</span></td></tr><tr id="type-strict_nonnull_origin.PrimitiveType" class="anchored"><td class="def variant constructor"><a href="#type-strict_nonnull_origin.PrimitiveType" class="anchor"></a><code><span>| </span><span><span class="constructor">PrimitiveType</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Primitive types are non-nullable by language design</p><span class="comment-delim">*)</span></td></tr><tr id="type-strict_nonnull_origin.ImplicitThis" class="anchored"><td class="def variant constructor"><a href="#type-strict_nonnull_origin.ImplicitThis" class="anchor"></a><code><span>| </span><span><span class="constructor">ImplicitThis</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Implicit `this` param for virtual non-static methods</p><span class="comment-delim">*)</span></td></tr><tr id="type-strict_nonnull_origin.EnumValue" class="anchored"><td class="def variant constructor"><a href="#type-strict_nonnull_origin.EnumValue" class="anchor"></a><code><span>| </span><span><span class="constructor">EnumValue</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Java enum value are statically initialized with non-nulls according to language semantics</p><span class="comment-delim">*)</span></td></tr><tr id="type-strict_nonnull_origin.SyntheticField" class="anchored"><td class="def variant constructor"><a href="#type-strict_nonnull_origin.SyntheticField" class="anchor"></a><code><span>| </span><span><span class="constructor">SyntheticField</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Fake field that is not part of user codebase, but rather artifact of codegen/annotation processor</p><span class="comment-delim">*)</span></td></tr></table></div></div><div class="odoc-spec"><div class="spec value" id="val-compare" class="anchored"><a href="#val-compare" class="anchor"></a><code><span><span class="keyword">val</span> compare : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-compare_nullable_origin" class="anchored"><a href="#val-compare_nullable_origin" class="anchor"></a><code><span><span class="keyword">val</span> compare_nullable_origin : <span><a href="#type-nullable_origin">nullable_origin</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-nullable_origin">nullable_origin</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-compare_unchecked_nonnull_origin" class="anchored"><a href="#val-compare_unchecked_nonnull_origin" class="anchor"></a><code><span><span class="keyword">val</span> compare_unchecked_nonnull_origin : <span><a href="#type-unchecked_nonnull_origin">unchecked_nonnull_origin</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-unchecked_nonnull_origin">unchecked_nonnull_origin</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-compare_strict_nonnull_origin" class="anchored"><a href="#val-compare_strict_nonnull_origin" class="anchor"></a><code><span><span class="keyword">val</span> compare_strict_nonnull_origin : <span><a href="#type-strict_nonnull_origin">strict_nonnull_origin</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-strict_nonnull_origin">strict_nonnull_origin</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-get_nullability" class="anchored"><a href="#val-get_nullability" class="anchor"></a><code><span><span class="keyword">val</span> get_nullability : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../Nullability/index.html#type-t">Nullability.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-of_type_and_annotation" class="anchored"><a href="#val-of_type_and_annotation" class="anchor"></a><code><span><span class="keyword">val</span> of_type_and_annotation : <span>is_callee_in_trust_list:bool <span class="arrow">&#45;&gt;</span></span> <span>nullsafe_mode:<a href="../NullsafeMode/index.html#type-t">NullsafeMode.t</a> <span class="arrow">&#45;&gt;</span></span>
<span>is_third_party:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="../../IR/Typ/index.html#type-t">IR.Typ.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../IR/Annot/Item/index.html#type-t">IR.Annot.Item.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Given the type and its annotations, returns its nullability. NOTE: it does not take into account models etc., so this is intended to be used as a helper function for more high-level annotation processing. <code>is_callee_in_trust_list</code> defines whether the callee class is in the caller's explicitly provided trust list and therefore whether its nullability should be refined.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-can_be_considered_for_provisional_annotation" class="anchored"><a href="#val-can_be_considered_for_provisional_annotation" class="anchor"></a><code><span><span class="keyword">val</span> can_be_considered_for_provisional_annotation : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>A method for the special mode where imaginary (provisional) <code>@Nullable</code> annotations are added to the code: see also <code>ProvisionalAnnotation.t</code>. This is a helper method useful for preliminary filtration of types that:</p><ul><li>can be semantically annotated as <code>@Nullable</code> in the source code e.g. non-primitive types</li><li>makes logical sense to annotate - e.g. the source code is under control.</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-pp" class="anchored"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div></div></body></html>